SELECT RIGHT(email, 5), LEFT(RIGHT(email, 4), 1)
FROM public.customer
WHERE LENGTH(email) < 30

SELECT LEFT(first_name, 1) || '.' || LEFT(last_name, 1) || '.' as Initials, first_name, last_name
FROM public.customer

SELECT LEFT(email, 1) || '***' || RIGHT(email, 19) as anon_email, email
FROM public.customer

SELECT email, last_name || ', ' || LEFT(email, POSITION(last_name IN email) -2) as  full_name
FROM public.customer



SELECT email, LEFT(email, 1) || '***' || SUBSTRING(email FROM POSITION('.' in email) FOR 2)
|| '***' || SUBSTRING(email FROM POSITION('@' in email))
FROM public.customer

SELECT email, '***' || SUBSTRING(email FROM POSITION(last_name in email)-2 FOR 3)
|| '***' || SUBSTRING(email FROM POSITION('@' in email))
FROM public.customer

SELECT customer_id, EXTRACT(week from payment_date) as week, SUM(amount) as amount
FROM public.payment
GROUP BY customer_id, EXTRACT(week from payment_date)
ORDER BY SUM(amount) DESC



SELECT SUM(amount) as total_amount, TO_CHAR(payment_date, 'Dy, DD/MM/YYYY') as day
FROM public.payment
GROUP BY TO_CHAR(payment_date, 'Dy, DD/MM/YYYY')
ORDER BY SUM(amount) asc

SELECT SUM(amount) as total_amount, TO_CHAR(payment_date, 'Mon, YYYY') as day
FROM public.payment
GROUP BY TO_CHAR(payment_date, 'Mon, YYYY')
ORDER BY SUM(amount) asc

SELECT SUM(amount) as total_amount, TO_CHAR(payment_date, 'Dy, HH:MI') as day
FROM public.payment
GROUP BY TO_CHAR(payment_date, 'Dy, HH:MI')
ORDER BY SUM(amount) desc



SELECT return_date - rental_date, customer_id
FROM public.rental
WHERE customer_id = 35

SELECT customer_id, AVG(return_date - rental_date)
FROM public.rental
GROUP BY customer_id
ORDER BY AVG(return_date - rental_date) DESC











